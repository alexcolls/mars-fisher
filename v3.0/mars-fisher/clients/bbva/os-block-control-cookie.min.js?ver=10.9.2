const IS_ALERT_BOX_CLOSED_AND_VALID="is_alert_box_closed_and_valid",closeCookiesPanelEvent=new CustomEvent(IS_ALERT_BOX_CLOSED_AND_VALID);function OptanonWrapper(){Optanon.IsAlertBoxClosedAndValid()&&document.dispatchEvent(closeCookiesPanelEvent)}function getJsonCookiesPromise(){return new Promise(function(e,t){var o=(new Date).getTime(),o=cb_options.storage_path+"config/cookies.json?ver="+o,a=new XMLHttpRequest;a.open("GET",o,!1),a.onload=function(){200<=a.status&&a.status<300?e(JSON.parse(a.response)):t({status:a.status,statusText:a.statusText})},a.onerror=function(){t({status:a.status,statusText:a.statusText})},a.send()})}var closeCookiesPanelPromise=new Promise(function(e){document.addEventListener(IS_ALERT_BOX_CLOSED_AND_VALID,e,!1)}),jsonCookiesPromise=getJsonCookiesPromise();let addthisInterval=null;function insertOtherScripts(e){var s="\x3c!-- Start header oneTrustScripts  --\x3e \n",r="\x3c!-- Start head_top oneTrustScripts  --\x3e \n",i="\x3c!-- Start body oneTrustScripts  --\x3e \n",c="\x3c!-- Start footer oneTrustScripts --\x3e \n";jQuery.each(e,function(e,t){var o=t.script,a=t.codigo,n=t.location,t=t.categoria_onetrust;-1!==OnetrustActiveGroups.indexOf(t)&&""!==t&&"C0001"!==t&&("head"!=n||"C0004"===t&&(t=getCountryCookies(),0<=o.indexOf("pixel"))&&(t="pixel"+t.toUpperCase(),0<=o.indexOf("pixelFacebookGlobal")&&(s=s+a+"\n"),o!==t)||(s=s+a+"\n"),"head_top"==n&&(r=r+a+"\n"),"body"==n&&(i=i+a+"\n"),"bottom"==n)&&(c=c+a+"\n")}),s+="\x3c!-- End header oneTrustScripts --\x3e",r+="\x3c!-- End head_top oneTrustScripts --\x3e",i+="\x3c!-- End body oneTrustScripts --\x3e",c+="\x3c!-- End footer oneTrustScripts --\x3e",jQuery("head").append(s),jQuery("head").prepend(r),jQuery("body").append(c),jQuery("body").prepend(i)}async function waitAddThisReady(){"undefined"!=typeof addthis&&(addthis.addEventListener("addthis.menu.share",shareEventHandler),clearInterval(addthisInterval),addthisInterval=null)}function shareEventHandler(e){"addthis.menu.share"==e.type&&(digitalData.page.pageActivity.link.url=e.data.service,digitalLink("External Link",digitalData))}function insertAdobeScript(){var e=document.createElement("script");e.type="text/javascript","prod"!==cb_options.env?e.src="//assets.adobedtm.com/95c3e405673d/5ac36e280641/launch-318eab83c809-development.min.js":e.src="//assets.adobedtm.com/95c3e405673d/5ac36e280641/launch-3754400f6e8a.min.js",document.getElementsByTagName("head")[0].appendChild(e)}function insertPixelCampaign(){var e=cb_options.pixel_campaign.type,t=cb_options.pixel_campaign.value;""!==t&&null!==t&&(pixelContentHTML="img"===e?'<img style="display: none" src="'+t+'" />':'<div style="display: none">'+t+"</div>",jQuery("body").append(pixelContentHTML),dbg.log("Pixel campaign inserted: "))}function insertSalesforceScript(){controlEncadenadaSalesforce();var e=document.createElement("script");e.type="text/javascript","prod"!==cb_options.env?e.src="//500008615.collect.igodigital.com/collect.js":e.src="//500008614.collect.igodigital.com/collect.js",document.getElementsByTagName("head")[0].appendChild(e),e.onload=function(){setTimeout(function(){"https://www.integrado.bbva.com"!==cb_options.site_url&&"https://integrado.bbva.com"!==cb_options.site_url&&"https://www.bbva.com"!==cb_options.site_url||(!1===jQuery("body").hasClass("category")?"post"!==dataTrackPosts.postType&&"interview"!==dataTrackPosts.postType&&"opinion"!==dataTrackPosts.postType&&"biography"!==dataTrackPosts.postType&&"sustainability"!==dataTrackPosts.postType&&"financialhealth"!==dataTrackPosts.postType&&"togetherness"!==dataTrackPosts.postType&&"innovation"!==dataTrackPosts.postType||jQuery("head").after(scriptTrackItemDetail):jQuery("head").after(scriptTrackCategory),""!==idUserTRack&&jQuery("head").after(scriptTrackUser),jQuery("head").after(scriptTrackBasicPush))},1e3)}}function getRecommenderByPercent(e){var t=getCookie("recommendedManualsCookie");return t&&""!==t||(t=e<Math.floor(100*Math.random())?"salesforce":"mediacenter",createCookie("recommendedManualsCookie",t)),t}function controlEncadenadaSalesforce(){var e,t=readJson("config/salesforce_settings.json"),o=new Array,a="",n="",s=t.api_salesforce_read_seconds,r=getRecommenderByPercent(t.api_salesforce_porcentage_manual||0);"on"==t.escenario_a&&"off"==t.escenario_b?(a="escenario_a",n=t.url_a):"off"==t.escenario_a&&"on"==t.escenario_b?(a="escenario_b",n=t.url_b):"on"==t.escenario_a&&"on"==t.escenario_b&&(n="escenario_a"==(a=(e=["escenario_a","escenario_b"])[Math.floor(Math.random()*e.length)])?t.url_a:t.url_b),"on"==t.salesforce&&"salesforce"==r?(o.push(a),o.push(n),o.push(s),"on"==t.escenario_s?o.push(t.url_s):o.push(n),"on"==t.escenario_fh?o.push(t.url_fh):o.push(n),"on"==t.escenario_j?o.push(t.url_j):o.push(n),"on"==t.escenario_i?o.push(t.url_i):o.push(n),e="lng_es","es"!=cb_options.language&&(e="lng_en"),o.push(e),createCookie("salesforceCookieNueva",o,5),typeRecommend="salesforce","function"==typeof salesforceCall&&salesforceCall()):(createCookie("salesforceCookieNueva","vacio",5),typeRecommend="mediacenter")}function controlYoutubeSRC(){jQuery("a.rs_preserve").each(function(){var e,t=jQuery(this).data("url");void 0!==t&&(e=t.includes("youtube-nocookie"),""!==t)&&e&&(urlYoutubeChanged=t.replace("www.youtube-nocookie.com","www.youtube.com"),jQuery(this).attr("data-url",urlYoutubeChanged))}),jQuery("a.linkModalVideo").each(function(){var e,t=jQuery(this).data("url");void 0!==t&&(e=t.includes("youtube-nocookie"),""!==t)&&e&&(urlYoutubeChanged=t.replace("www.youtube-nocookie.com","www.youtube.com"),jQuery(this).attr("data-url",urlYoutubeChanged))})}function getCountryCookies(){try{var e=new XMLHttpRequest,t=(e.open("GET",cb_options.site_url+"/bbva-components/utils/info?&project="+cb_options.code_webs_publicas,!1),e.send(null),JSON.parse(e.response));return 200===t.code&&t.data&&t.data.country?(cb_options.user_country=t.data.country,t.data.country.toLowerCase()):!1}catch(e){return!1}}Promise.all([jsonCookiesPromise,closeCookiesPanelPromise]).then(e=>{dbg.log("Onetrust Banner Closed",OnetrustActiveGroups),-1!==OnetrustActiveGroups.indexOf("C0003")?(dbg.log("Cookies de personalizacion aceptadas"),insertSalesforceScript(),controlYoutubeSRC()):(createCookie("salesforceCookieNueva","vacio",5),typeRecommend="mediacenter"),-1!==OnetrustActiveGroups.indexOf("C0002")&&(insertAdobeScript(),insertPixelCampaign()),insertOtherScripts(e[0]),-1!==OnetrustActiveGroups.indexOf("C0004")&&(addthisInterval=setInterval(waitAddThisReady,1e3))});
